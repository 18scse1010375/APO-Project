# Latest service_spec.yml file can be obtained from https://git.corp.adobe.com/adobe-platform/service-spec/blob/master/spec.yaml

service_name: apoconsole

# Operational
# Service Code is code generated by 'Atlas service registry' for your service. To generate one, go to https://atlas.adobe.io
# Read more about how to create an Atlas service code here: https://wiki.corp.adobe.com/x/N4O1ag
# service_code:

# Specify the owner of the service. Required for CCF compliance.
adobe_owner: nisbansa

version_control:
  base_branch: main

# Possible values are: Public, Internal, Confidential, Restricted.
data_classification: [Internal, Confidential]

#How to obtain correct cost center for your service: https://wiki.corp.adobe.com/x/TVr4W
adobe_cost_centers:
  # Mandatory if Dev or Stage environment is present
  # ADUS cost center is required in case of opex (Operational Expense)
  opex:
    # ADUS cost center (US-based)
    adus: 102321
  # Mandatory if Prod environment is present.
  # Both ADUS and ADIR cost centers are required in case of cogs (Cost of Goods Sold)
  cogs:
    # ADUS cost center (US-based)
    adus: 102321
    # ADIR cost center (Ireland-based)
    adir: 5490002

alerts:
  # Used to send the notification mails to the given list of IDs.
  # Accepts an array of email IDs.
  # At least one email ID is mandatory. Required for CCF compliance.
  emails: [nisbansa@adobe.com]



# Mandatory
# List of teams and their associated roles.
# There should be at least one item in this array.
# Only pre-defined roles can be used. The pre-defined roles are:
#   1. ethos_deployments_admin - Grants admin permissions on Moonbeam and Flight Director.
#   2. ethos_deployments_deployer - Grants deploy permissions on Moonbeam and Flight Director.
# At least one team should have 'ethos_deployments_admin' role.
# The person onboarding or re-onboarding the service should be part of atleast one team with 'ethos_deployments_admin' role.
# 'Mandatory' for new services getting onboarded.
# 'Optional' for existing services getting re-onboarded, for backward compatibility reasons.
team_access_control:
  -
    # Mandatory
    # Name of one of Github teams attached with this repository.
    name: apoconsole-admin-team
    # Mandatory
    # Array of roles. Allowed value are one or more of the pre-defined roles mentioned above.
    roles: [ethos_deployments_admin]
  -
    name: apoconsole-deploy-team
    # Default value for role is 'ethos_deployments_deployer'.
    # roles: [ethos_deployments_deployer]



images:
  - id: apoconsole-img

containers:
  - id: apoconsole
    image_id: apoconsole-img
    # Allowed values: DB, Cache, Worker, Router, AppServer, WebServer, DockerHost, LB, other (in case the none of listed values applies).
    class: AppServer
    # See https://git.corp.adobe.com/adobe-platform/service-spec/blob/60b4cca08bacb91657c20761939716b93f361a9a/spec.yaml#L141
    arch_path: BP.CCP.APO.apoconsole

environments:
  - name: Dev
    cluster_type: STAGE
    rollback_on_failure: true
    containers:
      - id: apoconsole
        topology: inet
        inet_port: 8080
        health_check:
          path: /ping
        cpus: 1
        mem: 2048
        instances: 1
        
        scaling:
          min_containers: 1
          max_containers: 1
          cpu_low_watermark: 30
          cpu_high_watermark: 70

        # By default, Glider creates services that are only accessible via Adobe egress IPs.
        # If you wish to change this behavior, see https://git.corp.adobe.com/adobe-platform/service-spec/blob/f7d7969177b9eddad9b7bc991f4fbbab506b5fd8/spec.yaml#L341-L352
        access_level: corp

    regions:
        - name: va6
